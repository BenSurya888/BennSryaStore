{% extends 'store/base.html' %}
{% load static %}
{% block title %}Home - BennSrya{% endblock %}

{% block content %}
<section class="hero">
  <div class="hero-inner container">
    <div class="hero-text">
      <h1>A great fun for everyone from</h1>
      <h2>BennSrya</h2>
      <p>Tempat Top Up Game, App Prem & Belanja Online Terpercaya. Cepat, Aman, dan Praktis!</p>
    </div>
    <div class="hero-image">
      <img src="{% static 'store/img/hero.png' %}" alt="hero">
    </div>
  </div>
</section>

{% for category, product_list in products_by_category.items %}
<section class="category-section container">
  <h2 class="category-title">{{ category|title }}</h2>
  <div class="product-carousel" id="carousel-{{ category }}">
    {% for product in product_list %}
      <article class="card" data-category="{{ product.category }}">
        <a href="{% url 'bensryaa:product_detail' product.id %}">
          <img src="{{ product.logo_url }}" alt="{{ product.brand }}">
          <div class="meta">
            <h3>{{ product.brand }}</h3>
          </div>
        </a>
      </article>
    {% endfor %}
  </div>
  <div class="load-more-wrapper">
    <button class="load-more-btn" data-category="{{ category }}">⬇️ Load More</button>
  </div>
</section>
{% endfor %}

<style>
.product-carousel {
  display: flex;
  gap: 1rem;
  overflow-x: auto;
  scroll-snap-type: x mandatory;
  padding-bottom: 1rem;
}
.product-carousel .card {
  flex: 0 0 auto;
  width: 250px;
  scroll-snap-align: start;
}
</style>

<script>
document.querySelectorAll('.category-section').forEach(section => {
  const category = section.querySelector('.load-more-btn').dataset.category;
  const cards = section.querySelectorAll('.card');
  let visibleCount = 6;
  showCards();

  section.querySelector('.load-more-btn').addEventListener('click', () => {
    visibleCount += 6;
    showCards();
  });

  function showCards() {
    cards.forEach((card, i) => {
      card.style.display = i < visibleCount ? "block" : "none";
    });
    if (visibleCount >= cards.length) {
      section.querySelector('.load-more-btn').style.display = "none";
    }
  }
});
</script>
{% endblock %}
